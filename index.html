<!doctype html>
<html>
<head>
  <meta charset='utf-8'/>
  <title>FreshLeads Dashboard</title>
  <meta name='viewport' content='width=device-width,initial-scale=1'/>
  <style>
    body{font-family:Arial,sans-serif;max-width:1100px;margin:20px auto;padding:10px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:6px;border-bottom:1px solid #eee;text-align:left}
    input, select{padding:8px;margin:6px 0}
  </style>
</head>
<body>
  <h1>FreshLeads — Dashboard</h1>
  <p>Last update: <span id="updated">-</span> — Total: <span id="count">-</span></p>

  <label>Filter by niche:
    <select id="nicheFilter">
      <option value="">All</option>
      <option value="clinics">Clinics</option>
      <option value="ecom">E-commerce</option>
      <option value="services">Services</option>
      <option value="other">Other</option>
    </select>
  </label>
  <label>Search:
    <input type="search" id="q" placeholder="domain or title"/>
  </label>
  <button id="refresh">Refresh</button>
  <p><a id="downloadAll" href="#" target="_blank">Download master CSV</a></p>

  <table id="tbl"><thead><tr><th>Domain</th><th>Title</th><th>Niche</th><th>Score</th></tr></thead><tbody></tbody></table>

<script>
const RAW_CSV = "https://raw.githubusercontent.com/YOUR_GITHUB_USERNAME/freshleads/main/fresh_domains_latest.csv";
const FEED_JSON = "https://raw.githubusercontent.com/YOUR_GITHUB_USERNAME/freshleads/main/feed.json";

async function load(){
  try {
    const res = await fetch(FEED_JSON);
    const feed = await res.json();
    document.getElementById("updated").innerText = feed.updated;
    document.getElementById("count").innerText = feed.count;
    window.feedItems = feed.items;
    render();
  } catch(e){
    document.getElementById("updated").innerText = "no data yet";
    document.getElementById("count").innerText = "0";
    window.feedItems = [];
  }
}

function render(){
  const niche = document.getElementById("nicheFilter").value;
  const q = document.getElementById("q").value.toLowerCase();
  const tbody = document.querySelector("#tbl tbody");
  tbody.innerHTML = "";
  const items = (window.feedItems || []).filter(item=>{
    if(niche && item.niche !== niche) return false;
    if(q && !(item.domain.includes(q) || (item.title && item.title.toLowerCase().includes(q)))) return false;
    return true;
  });
  for(const it of items.slice(0,500)){
    const tr = document.createElement("tr");
    tr.innerHTML = <td><a href="http://" target="_blank"></a></td>
                    <td></td>
                    <td></td>
                    <td></td>;
    tbody.appendChild(tr);
  }
  document.getElementById("downloadAll").href = "https://raw.githubusercontent.com/YOUR_GITHUB_USERNAME/freshleads/main/fresh_domains_latest.csv";
}

document.getElementById("nicheFilter").addEventListener("change", render);
document.getElementById("q").addEventListener("input", render);
document.getElementById("refresh").addEventListener("click", load);

load();
</script>
</body>
</html>
